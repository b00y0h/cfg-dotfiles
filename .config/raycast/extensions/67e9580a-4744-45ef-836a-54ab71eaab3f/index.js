"use strict";var rs=Object.create;var Kt=Object.defineProperty;var ns=Object.getOwnPropertyDescriptor;var os=Object.getOwnPropertyNames;var as=Object.getPrototypeOf,is=Object.prototype.hasOwnProperty;var dt=(r,o)=>()=>(o||r((o={exports:{}}).exports,o),o.exports),ss=(r,o)=>{for(var a in o)Kt(r,a,{get:o[a],enumerable:!0})},jo=(r,o,a,s)=>{if(o&&typeof o=="object"||typeof o=="function")for(let l of os(o))!is.call(r,l)&&l!==a&&Kt(r,l,{get:()=>o[l],enumerable:!(s=ns(o,l))||s.enumerable});return r};var oe=(r,o,a)=>(a=r!=null?rs(as(r)):{},jo(o||!r||!r.__esModule?Kt(a,"default",{value:r,enumerable:!0}):a,r)),us=r=>jo(Kt({},"__esModule",{value:!0}),r);var Go=dt((ht,Ve)=>{var ls=9007199254740991,fs="[object Arguments]",cs="[object Function]",ds="[object GeneratorFunction]",Qr="[object Map]",hs="[object Object]",zo="[object Promise]",Gr="[object Set]",Fo="[object WeakMap]",Lo="[object DataView]",ms=/[\\^$.*+?()[\]{}|]/g,ps=/^\[object .+?Constructor\]$/,bs=typeof global=="object"&&global&&global.Object===Object&&global,ys=typeof self=="object"&&self&&self.Object===Object&&self,Oe=bs||ys||Function("return this")(),No=typeof ht=="object"&&ht&&!ht.nodeType&&ht,Do=No&&typeof Ve=="object"&&Ve&&!Ve.nodeType&&Ve,gs=Do&&Do.exports===No;function _s(r,o){return r?.[o]}function Ss(r){var o=!1;if(r!=null&&typeof r.toString!="function")try{o=!!(r+"")}catch{}return o}function ws(r,o){return function(a){return r(o(a))}}var Rs=Function.prototype,Jt=Object.prototype,Vr=Oe["__core-js_shared__"],$o=function(){var r=/[^.]+$/.exec(Vr&&Vr.keys&&Vr.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),xo=Rs.toString,en=Jt.hasOwnProperty,Zt=Jt.toString,Cs=RegExp("^"+xo.call(en).replace(ms,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Mo=gs?Oe.Buffer:void 0,Uo=Jt.propertyIsEnumerable,Ts=Mo?Mo.isBuffer:void 0,Ps=ws(Object.keys,Object),Yr=mt(Oe,"DataView"),Kr=mt(Oe,"Map"),Jr=mt(Oe,"Promise"),Zr=mt(Oe,"Set"),Xr=mt(Oe,"WeakMap"),Es=!Uo.call({valueOf:1},"valueOf"),vs=qe(Yr),As=qe(Kr),ks=qe(Jr),Bs=qe(Zr),Is=qe(Xr);function Ws(r){return Zt.call(r)}function Os(r){if(!Qo(r)||qs(r))return!1;var o=Vo(r)||Ss(r)?Cs:ps;return o.test(qe(r))}function mt(r,o){var a=_s(r,o);return Os(a)?a:void 0}var We=Ws;(Yr&&We(new Yr(new ArrayBuffer(1)))!=Lo||Kr&&We(new Kr)!=Qr||Jr&&We(Jr.resolve())!=zo||Zr&&We(new Zr)!=Gr||Xr&&We(new Xr)!=Fo)&&(We=function(r){var o=Zt.call(r),a=o==hs?r.constructor:void 0,s=a?qe(a):void 0;if(s)switch(s){case vs:return Lo;case As:return Qr;case ks:return zo;case Bs:return Gr;case Is:return Fo}return o});function qs(r){return!!$o&&$o in r}function js(r){var o=r&&r.constructor,a=typeof o=="function"&&o.prototype||Jt;return r===a}function qe(r){if(r!=null){try{return xo.call(r)}catch{}try{return r+""}catch{}}return""}function zs(r){return Ls(r)&&en.call(r,"callee")&&(!Uo.call(r,"callee")||Zt.call(r)==fs)}var Fs=Array.isArray;function Ho(r){return r!=null&&Ms(r.length)&&!Vo(r)}function Ls(r){return Ns(r)&&Ho(r)}var Ds=Ts||xs;function $s(r){if(Ho(r)&&(Fs(r)||typeof r=="string"||typeof r.splice=="function"||Ds(r)||zs(r)))return!r.length;var o=We(r);if(o==Qr||o==Gr)return!r.size;if(Es||js(r))return!Ps(r).length;for(var a in r)if(en.call(r,a))return!1;return!0}function Vo(r){var o=Qo(r)?Zt.call(r):"";return o==cs||o==ds}function Ms(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ls}function Qo(r){var o=typeof r;return!!r&&(o=="object"||o=="function")}function Ns(r){return!!r&&typeof r=="object"}function xs(){return!1}Ve.exports=$s});var ta=dt((el,ea)=>{var Us=200,nn="__lodash_hash_undefined__",Hs=1/0,Vs="[object Function]",Qs="[object GeneratorFunction]",Gs=/[\\^$.*+?()[\]{}|]/g,Ys=/^\[object .+?Constructor\]$/,Ks=typeof global=="object"&&global&&global.Object===Object&&global,Js=typeof self=="object"&&self&&self.Object===Object&&self,on=Ks||Js||Function("return this")();function Zs(r,o){var a=r?r.length:0;return!!a&&tu(r,o,0)>-1}function Xs(r,o,a){for(var s=-1,l=r?r.length:0;++s<l;)if(a(o,r[s]))return!0;return!1}function eu(r,o,a,s){for(var l=r.length,d=a+(s?1:-1);s?d--:++d<l;)if(o(r[d],d,r))return d;return-1}function tu(r,o,a){if(o!==o)return eu(r,ru,a);for(var s=a-1,l=r.length;++s<l;)if(r[s]===o)return s;return-1}function ru(r){return r!==r}function nu(r,o){return r.has(o)}function ou(r,o){return r?.[o]}function au(r){var o=!1;if(r!=null&&typeof r.toString!="function")try{o=!!(r+"")}catch{}return o}function Ko(r){var o=-1,a=Array(r.size);return r.forEach(function(s){a[++o]=s}),a}var iu=Array.prototype,su=Function.prototype,Jo=Object.prototype,tn=on["__core-js_shared__"],Yo=function(){var r=/[^.]+$/.exec(tn&&tn.keys&&tn.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Zo=su.toString,an=Jo.hasOwnProperty,uu=Jo.toString,lu=RegExp("^"+Zo.call(an).replace(Gs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fu=iu.splice,cu=sn(on,"Map"),rn=sn(on,"Set"),pt=sn(Object,"create");function je(r){var o=-1,a=r?r.length:0;for(this.clear();++o<a;){var s=r[o];this.set(s[0],s[1])}}function du(){this.__data__=pt?pt(null):{}}function hu(r){return this.has(r)&&delete this.__data__[r]}function mu(r){var o=this.__data__;if(pt){var a=o[r];return a===nn?void 0:a}return an.call(o,r)?o[r]:void 0}function pu(r){var o=this.__data__;return pt?o[r]!==void 0:an.call(o,r)}function bu(r,o){var a=this.__data__;return a[r]=pt&&o===void 0?nn:o,this}je.prototype.clear=du;je.prototype.delete=hu;je.prototype.get=mu;je.prototype.has=pu;je.prototype.set=bu;function Qe(r){var o=-1,a=r?r.length:0;for(this.clear();++o<a;){var s=r[o];this.set(s[0],s[1])}}function yu(){this.__data__=[]}function gu(r){var o=this.__data__,a=er(o,r);if(a<0)return!1;var s=o.length-1;return a==s?o.pop():fu.call(o,a,1),!0}function _u(r){var o=this.__data__,a=er(o,r);return a<0?void 0:o[a][1]}function Su(r){return er(this.__data__,r)>-1}function wu(r,o){var a=this.__data__,s=er(a,r);return s<0?a.push([r,o]):a[s][1]=o,this}Qe.prototype.clear=yu;Qe.prototype.delete=gu;Qe.prototype.get=_u;Qe.prototype.has=Su;Qe.prototype.set=wu;function Ge(r){var o=-1,a=r?r.length:0;for(this.clear();++o<a;){var s=r[o];this.set(s[0],s[1])}}function Ru(){this.__data__={hash:new je,map:new(cu||Qe),string:new je}}function Cu(r){return tr(this,r).delete(r)}function Tu(r){return tr(this,r).get(r)}function Pu(r){return tr(this,r).has(r)}function Eu(r,o){return tr(this,r).set(r,o),this}Ge.prototype.clear=Ru;Ge.prototype.delete=Cu;Ge.prototype.get=Tu;Ge.prototype.has=Pu;Ge.prototype.set=Eu;function Xt(r){var o=-1,a=r?r.length:0;for(this.__data__=new Ge;++o<a;)this.add(r[o])}function vu(r){return this.__data__.set(r,nn),this}function Au(r){return this.__data__.has(r)}Xt.prototype.add=Xt.prototype.push=vu;Xt.prototype.has=Au;function er(r,o){for(var a=r.length;a--;)if(zu(r[a][0],o))return a;return-1}function ku(r){if(!Xo(r)||Ou(r))return!1;var o=Fu(r)||au(r)?lu:Ys;return o.test(qu(r))}function Bu(r,o,a){var s=-1,l=Zs,d=r.length,p=!0,m=[],g=m;if(a)p=!1,l=Xs;else if(d>=Us){var S=o?null:Iu(r);if(S)return Ko(S);p=!1,l=nu,g=new Xt}else g=o?[]:m;e:for(;++s<d;){var P=r[s],C=o?o(P):P;if(P=a||P!==0?P:0,p&&C===C){for(var w=g.length;w--;)if(g[w]===C)continue e;o&&g.push(C),m.push(P)}else l(g,C,a)||(g!==m&&g.push(C),m.push(P))}return m}var Iu=rn&&1/Ko(new rn([,-0]))[1]==Hs?function(r){return new rn(r)}:Lu;function tr(r,o){var a=r.__data__;return Wu(o)?a[typeof o=="string"?"string":"hash"]:a.map}function sn(r,o){var a=ou(r,o);return ku(a)?a:void 0}function Wu(r){var o=typeof r;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?r!=="__proto__":r===null}function Ou(r){return!!Yo&&Yo in r}function qu(r){if(r!=null){try{return Zo.call(r)}catch{}try{return r+""}catch{}}return""}function ju(r,o){return r&&r.length?Bu(r,void 0,o):[]}function zu(r,o){return r===o||r!==r&&o!==o}function Fu(r){var o=Xo(r)?uu.call(r):"";return o==Vs||o==Qs}function Xo(r){var o=typeof r;return!!r&&(o=="object"||o=="function")}function Lu(){}ea.exports=ju});var na=dt((tl,ra)=>{"use strict";function Du(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let o=r.indexOf(",");if(o===-1||o<=4)throw new TypeError("malformed data: URI");let a=r.substring(5,o).split(";"),s="",l=!1,d=a[0]||"text/plain",p=d;for(let P=1;P<a.length;P++)a[P]==="base64"?l=!0:(p+=`;${a[P]}`,a[P].indexOf("charset=")===0&&(s=a[P].substring(8)));!a[0]&&!s.length&&(p+=";charset=US-ASCII",s="US-ASCII");let m=l?"base64":"ascii",g=unescape(r.substring(o+1)),S=Buffer.from(g,m);return S.type=d,S.typeFull=p,S.charset=s,S}ra.exports=Du});var aa=dt((rr,oa)=>{(function(r,o){typeof rr=="object"&&typeof oa<"u"?o(rr):typeof define=="function"&&define.amd?define(["exports"],o):(r=typeof globalThis<"u"?globalThis:r||self,o(r.WebStreamsPolyfill={}))})(rr,function(r){"use strict";let o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function a(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let l=s();function d(e){return typeof e=="object"&&e!==null||typeof e=="function"}let p=a,m=Promise,g=Promise.prototype.then,S=Promise.resolve.bind(m),P=Promise.reject.bind(m);function C(e){return new m(e)}function w(e){return S(e)}function h(e){return P(e)}function k(e,t,n){return g.call(e,t,n)}function v(e,t,n){k(k(e,t,n),void 0,p)}function U(e,t){v(e,t)}function te(e,t){v(e,void 0,t)}function ie(e,t,n){return k(e,t,n)}function se(e){k(e,void 0,p)}let Q=(()=>{let e=l&&l.queueMicrotask;if(typeof e=="function")return e;let t=w(void 0);return n=>k(t,n)})();function ue(e,t,n){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}function Pe(e,t,n){try{return w(ue(e,t,n))}catch(i){return h(i)}}let gn=16384;class G{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let n=this._back,i=n;n._elements.length===gn-1&&(i={_elements:[],_next:void 0}),n._elements.push(t),i!==n&&(this._back=i,n._next=i),++this._size}shift(){let t=this._front,n=t,i=this._cursor,u=i+1,f=t._elements,c=f[i];return u===gn&&(n=t._next,u=0),--this._size,this._cursor=u,t!==n&&(this._front=n),f[i]=void 0,c}forEach(t){let n=this._cursor,i=this._front,u=i._elements;for(;(n!==u.length||i._next!==void 0)&&!(n===u.length&&(i=i._next,u=i._elements,n=0,u.length===0));)t(u[n]),++n}peek(){let t=this._front,n=this._cursor;return t._elements[n]}}function _n(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?mr(e):t._state==="closed"?Ia(e):Sn(e,t._storedError)}function hr(e,t){let n=e._ownerReadableStream;return J(n,t)}function le(e){e._ownerReadableStream._state==="readable"?pr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Wa(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function Le(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function mr(e){e._closedPromise=C((t,n)=>{e._closedPromise_resolve=t,e._closedPromise_reject=n})}function Sn(e,t){mr(e),pr(e,t)}function Ia(e){mr(e),wn(e)}function pr(e,t){e._closedPromise_reject!==void 0&&(se(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Wa(e,t){Sn(e,t)}function wn(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Rn=o("[[AbortSteps]]"),Cn=o("[[ErrorSteps]]"),br=o("[[CancelSteps]]"),yr=o("[[PullSteps]]"),Tn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Oa=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function qa(e){return typeof e=="object"||typeof e=="function"}function fe(e,t){if(e!==void 0&&!qa(e))throw new TypeError(`${t} is not an object.`)}function Y(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function ja(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Pn(e,t){if(!ja(e))throw new TypeError(`${t} is not an object.`)}function ce(e,t,n){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${n}'.`)}function gr(e,t,n){if(e===void 0)throw new TypeError(`${t} is required in '${n}'.`)}function _r(e){return Number(e)}function En(e){return e===0?0:e}function za(e){return En(Oa(e))}function vn(e,t){let i=Number.MAX_SAFE_INTEGER,u=Number(e);if(u=En(u),!Tn(u))throw new TypeError(`${t} is not a finite number`);if(u=za(u),u<0||u>i)throw new TypeError(`${t} is outside the accepted range of ${0} to ${i}, inclusive`);return!Tn(u)||u===0?0:u}function Sr(e,t){if(!_e(e))throw new TypeError(`${t} is not a ReadableStream.`)}function De(e){return new Ke(e)}function An(e,t){e._reader._readRequests.push(t)}function wr(e,t,n){let u=e._reader._readRequests.shift();n?u._closeSteps():u._chunkSteps(t)}function _t(e){return e._reader._readRequests.length}function kn(e){let t=e._reader;return!(t===void 0||!pe(t))}class Ke{constructor(t){if(ce(t,1,"ReadableStreamDefaultReader"),Sr(t,"First parameter"),Se(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");_n(this,t),this._readRequests=new G}get closed(){return pe(this)?this._closedPromise:h(St("closed"))}cancel(t=void 0){return pe(this)?this._ownerReadableStream===void 0?h(Le("cancel")):hr(this,t):h(St("cancel"))}read(){if(!pe(this))return h(St("read"));if(this._ownerReadableStream===void 0)return h(Le("read from"));let t,n,i=C((f,c)=>{t=f,n=c});return Je(this,{_chunkSteps:f=>t({value:f,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:f=>n(f)}),i}releaseLock(){if(!pe(this))throw St("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");le(this)}}}Object.defineProperties(Ke.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(Ke.prototype,o.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function pe(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Ke}function Je(e,t){let n=e._ownerReadableStream;n._disturbed=!0,n._state==="closed"?t._closeSteps():n._state==="errored"?t._errorSteps(n._storedError):n._readableStreamController[yr](t)}function St(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Bn=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class In{constructor(t,n){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=n}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?ie(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let n=()=>this._returnSteps(t);return this._ongoingPromise?ie(this._ongoingPromise,n,n):n()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return h(Le("iterate"));let n,i,u=C((c,b)=>{n=c,i=b});return Je(t,{_chunkSteps:c=>{this._ongoingPromise=void 0,Q(()=>n({value:c,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,le(t),n({value:void 0,done:!0})},_errorSteps:c=>{this._ongoingPromise=void 0,this._isFinished=!0,le(t),i(c)}}),u}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let n=this._reader;if(n._ownerReadableStream===void 0)return h(Le("finish iterating"));if(!this._preventCancel){let i=hr(n,t);return le(n),ie(i,()=>({value:t,done:!0}))}return le(n),w({value:t,done:!0})}}let Wn={next(){return On(this)?this._asyncIteratorImpl.next():h(qn("next"))},return(e){return On(this)?this._asyncIteratorImpl.return(e):h(qn("return"))}};Bn!==void 0&&Object.setPrototypeOf(Wn,Bn);function Fa(e,t){let n=De(e),i=new In(n,t),u=Object.create(Wn);return u._asyncIteratorImpl=i,u}function On(e){if(!d(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof In}catch{return!1}}function qn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let jn=Number.isNaN||function(e){return e!==e};function Ze(e){return e.slice()}function zn(e,t,n,i,u){new Uint8Array(e).set(new Uint8Array(n,i,u),t)}function Zu(e){return e}function wt(e){return!1}function Fn(e,t,n){if(e.slice)return e.slice(t,n);let i=n-t,u=new ArrayBuffer(i);return zn(u,0,e,t,i),u}function La(e){return!(typeof e!="number"||jn(e)||e<0)}function Ln(e){let t=Fn(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Rr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Cr(e,t,n){if(!La(n)||n===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n}function Da(e){return e._queue.peek().value}function be(e){e._queue=new G,e._queueTotalSize=0}class Xe{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Tr(this))throw kr("view");return this._view}respond(t){if(!Tr(this))throw kr("respond");if(ce(t,1,"respond"),t=vn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");wt(this._view.buffer),Pt(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Tr(this))throw kr("respondWithNewView");if(ce(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");wt(t.buffer),Et(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Xe.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(Xe.prototype,o.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class $e{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ee(this))throw tt("byobRequest");return Ar(this)}get desiredSize(){if(!Ee(this))throw tt("desiredSize");return Vn(this)}close(){if(!Ee(this))throw tt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);et(this)}enqueue(t){if(!Ee(this))throw tt("enqueue");if(ce(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let n=this._controlledReadableByteStream._state;if(n!=="readable")throw new TypeError(`The stream (in ${n} state) is not in the readable state and cannot be enqueued to`);Tt(this,t)}error(t=void 0){if(!Ee(this))throw tt("error");K(this,t)}[br](t){Dn(this),be(this);let n=this._cancelAlgorithm(t);return Ct(this),n}[yr](t){let n=this._controlledReadableByteStream;if(this._queueTotalSize>0){let u=this._queue.shift();this._queueTotalSize-=u.byteLength,xn(this);let f=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);t._chunkSteps(f);return}let i=this._autoAllocateChunkSize;if(i!==void 0){let u;try{u=new ArrayBuffer(i)}catch(c){t._errorSteps(c);return}let f={buffer:u,bufferByteLength:i,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(f)}An(n,t),ve(this)}}Object.defineProperties($e.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty($e.prototype,o.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ee(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof $e}function Tr(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Xe}function ve(e){if(!xa(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let n=e._pullAlgorithm();v(n,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ve(e))},i=>{K(e,i)})}function Dn(e){Er(e),e._pendingPullIntos=new G}function Pr(e,t){let n=!1;e._state==="closed"&&(n=!0);let i=$n(t);t.readerType==="default"?wr(e,i,n):Va(e,i,n)}function $n(e){let t=e.bytesFilled,n=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/n)}function Rt(e,t,n,i){e._queue.push({buffer:t,byteOffset:n,byteLength:i}),e._queueTotalSize+=i}function Mn(e,t){let n=t.elementSize,i=t.bytesFilled-t.bytesFilled%n,u=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),f=t.bytesFilled+u,c=f-f%n,b=u,_=!1;c>i&&(b=c-t.bytesFilled,_=!0);let T=e._queue;for(;b>0;){let W=T.peek(),B=Math.min(b,W.byteLength),q=t.byteOffset+t.bytesFilled;zn(t.buffer,q,W.buffer,W.byteOffset,B),W.byteLength===B?T.shift():(W.byteOffset+=B,W.byteLength-=B),e._queueTotalSize-=B,Nn(e,B,t),b-=B}return _}function Nn(e,t,n){n.bytesFilled+=t}function xn(e){e._queueTotalSize===0&&e._closeRequested?(Ct(e),lt(e._controlledReadableByteStream)):ve(e)}function Er(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Un(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();Mn(e,t)&&(vr(e),Pr(e._controlledReadableByteStream,t))}}function $a(e,t,n){let i=e._controlledReadableByteStream,u=1;t.constructor!==DataView&&(u=t.constructor.BYTES_PER_ELEMENT);let f=t.constructor,c=t.buffer,b={buffer:c,bufferByteLength:c.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:u,viewConstructor:f,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(b),Yn(i,n);return}if(i._state==="closed"){let _=new f(b.buffer,b.byteOffset,0);n._closeSteps(_);return}if(e._queueTotalSize>0){if(Mn(e,b)){let _=$n(b);xn(e),n._chunkSteps(_);return}if(e._closeRequested){let _=new TypeError("Insufficient bytes to fill elements in the given buffer");K(e,_),n._errorSteps(_);return}}e._pendingPullIntos.push(b),Yn(i,n),ve(e)}function Ma(e,t){let n=e._controlledReadableByteStream;if(Br(n))for(;Kn(n)>0;){let i=vr(e);Pr(n,i)}}function Na(e,t,n){if(Nn(e,t,n),n.bytesFilled<n.elementSize)return;vr(e);let i=n.bytesFilled%n.elementSize;if(i>0){let u=n.byteOffset+n.bytesFilled,f=Fn(n.buffer,u-i,u);Rt(e,f,0,f.byteLength)}n.bytesFilled-=i,Pr(e._controlledReadableByteStream,n),Un(e)}function Hn(e,t){let n=e._pendingPullIntos.peek();Er(e),e._controlledReadableByteStream._state==="closed"?Ma(e):Na(e,t,n),ve(e)}function vr(e){return e._pendingPullIntos.shift()}function xa(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(kn(t)&&_t(t)>0||Br(t)&&Kn(t)>0||Vn(e)>0)}function Ct(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function et(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let i=new TypeError("Insufficient bytes to fill elements in the given buffer");throw K(e,i),i}Ct(e),lt(t)}}function Tt(e,t){let n=e._controlledReadableByteStream;if(e._closeRequested||n._state!=="readable")return;let i=t.buffer,u=t.byteOffset,f=t.byteLength,c=i;if(e._pendingPullIntos.length>0){let b=e._pendingPullIntos.peek();wt(b.buffer),b.buffer=b.buffer}if(Er(e),kn(n))if(_t(n)===0)Rt(e,c,u,f);else{let b=new Uint8Array(c,u,f);wr(n,b,!1)}else Br(n)?(Rt(e,c,u,f),Un(e)):Rt(e,c,u,f);ve(e)}function K(e,t){let n=e._controlledReadableByteStream;n._state==="readable"&&(Dn(e),be(e),Ct(e),wo(n,t))}function Ar(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),n=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(Xe.prototype);Ha(i,e,n),e._byobRequest=i}return e._byobRequest}function Vn(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Pt(e,t){let n=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range")}n.buffer=n.buffer,Hn(e,t)}function Et(e,t){let n=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(n.bytesFilled+t.byteLength>n.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");n.buffer=t.buffer,Hn(e,t.byteLength)}function Qn(e,t,n,i,u,f,c){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,be(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=f,t._pullAlgorithm=i,t._cancelAlgorithm=u,t._autoAllocateChunkSize=c,t._pendingPullIntos=new G,e._readableStreamController=t;let b=n();v(w(b),()=>{t._started=!0,ve(t)},_=>{K(t,_)})}function Ua(e,t,n){let i=Object.create($e.prototype),u=()=>{},f=()=>w(void 0),c=()=>w(void 0);t.start!==void 0&&(u=()=>t.start(i)),t.pull!==void 0&&(f=()=>t.pull(i)),t.cancel!==void 0&&(c=_=>t.cancel(_));let b=t.autoAllocateChunkSize;if(b===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Qn(e,i,u,f,c,n,b)}function Ha(e,t,n){e._associatedReadableByteStreamController=t,e._view=n}function kr(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function tt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Gn(e){return new rt(e)}function Yn(e,t){e._reader._readIntoRequests.push(t)}function Va(e,t,n){let u=e._reader._readIntoRequests.shift();n?u._closeSteps(t):u._chunkSteps(t)}function Kn(e){return e._reader._readIntoRequests.length}function Br(e){let t=e._reader;return!(t===void 0||!Ae(t))}class rt{constructor(t){if(ce(t,1,"ReadableStreamBYOBReader"),Sr(t,"First parameter"),Se(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ee(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");_n(this,t),this._readIntoRequests=new G}get closed(){return Ae(this)?this._closedPromise:h(vt("closed"))}cancel(t=void 0){return Ae(this)?this._ownerReadableStream===void 0?h(Le("cancel")):hr(this,t):h(vt("cancel"))}read(t){if(!Ae(this))return h(vt("read"));if(!ArrayBuffer.isView(t))return h(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return h(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return h(new TypeError("view's buffer must have non-zero byteLength"));if(wt(t.buffer),this._ownerReadableStream===void 0)return h(Le("read from"));let n,i,u=C((c,b)=>{n=c,i=b});return Jn(this,t,{_chunkSteps:c=>n({value:c,done:!1}),_closeSteps:c=>n({value:c,done:!0}),_errorSteps:c=>i(c)}),u}releaseLock(){if(!Ae(this))throw vt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");le(this)}}}Object.defineProperties(rt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(rt.prototype,o.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Ae(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof rt}function Jn(e,t,n){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="errored"?n._errorSteps(i._storedError):$a(i._readableStreamController,t,n)}function vt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function nt(e,t){let{highWaterMark:n}=e;if(n===void 0)return t;if(jn(n)||n<0)throw new RangeError("Invalid highWaterMark");return n}function At(e){let{size:t}=e;return t||(()=>1)}function kt(e,t){fe(e,t);let n=e?.highWaterMark,i=e?.size;return{highWaterMark:n===void 0?void 0:_r(n),size:i===void 0?void 0:Qa(i,`${t} has member 'size' that`)}}function Qa(e,t){return Y(e,t),n=>_r(e(n))}function Ga(e,t){fe(e,t);let n=e?.abort,i=e?.close,u=e?.start,f=e?.type,c=e?.write;return{abort:n===void 0?void 0:Ya(n,e,`${t} has member 'abort' that`),close:i===void 0?void 0:Ka(i,e,`${t} has member 'close' that`),start:u===void 0?void 0:Ja(u,e,`${t} has member 'start' that`),write:c===void 0?void 0:Za(c,e,`${t} has member 'write' that`),type:f}}function Ya(e,t,n){return Y(e,n),i=>Pe(e,t,[i])}function Ka(e,t,n){return Y(e,n),()=>Pe(e,t,[])}function Ja(e,t,n){return Y(e,n),i=>ue(e,t,[i])}function Za(e,t,n){return Y(e,n),(i,u)=>Pe(e,t,[i,u])}function Zn(e,t){if(!Me(e))throw new TypeError(`${t} is not a WritableStream.`)}function Xa(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let ei=typeof AbortController=="function";function ti(){if(ei)return new AbortController}class ot{constructor(t={},n={}){t===void 0?t=null:Pn(t,"First parameter");let i=kt(n,"Second parameter"),u=Ga(t,"First parameter");if(eo(this),u.type!==void 0)throw new RangeError("Invalid type is specified");let c=At(i),b=nt(i,1);pi(this,u,b,c)}get locked(){if(!Me(this))throw qt("locked");return Ne(this)}abort(t=void 0){return Me(this)?Ne(this)?h(new TypeError("Cannot abort a stream that already has a writer")):Bt(this,t):h(qt("abort"))}close(){return Me(this)?Ne(this)?h(new TypeError("Cannot close a stream that already has a writer")):re(this)?h(new TypeError("Cannot close an already-closing stream")):to(this):h(qt("close"))}getWriter(){if(!Me(this))throw qt("getWriter");return Xn(this)}}Object.defineProperties(ot.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(ot.prototype,o.toStringTag,{value:"WritableStream",configurable:!0});function Xn(e){return new at(e)}function ri(e,t,n,i,u=1,f=()=>1){let c=Object.create(ot.prototype);eo(c);let b=Object.create(xe.prototype);return so(c,b,e,t,n,i,u,f),c}function eo(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new G,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function Me(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof ot}function Ne(e){return e._writer!==void 0}function Bt(e,t){var n;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=t,(n=e._writableStreamController._abortController)===null||n===void 0||n.abort();let i=e._state;if(i==="closed"||i==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let u=!1;i==="erroring"&&(u=!0,t=void 0);let f=C((c,b)=>{e._pendingAbortRequest={_promise:void 0,_resolve:c,_reject:b,_reason:t,_wasAlreadyErroring:u}});return e._pendingAbortRequest._promise=f,u||Wr(e,t),f}function to(e){let t=e._state;if(t==="closed"||t==="errored")return h(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let n=C((u,f)=>{let c={_resolve:u,_reject:f};e._closeRequest=c}),i=e._writer;return i!==void 0&&e._backpressure&&t==="writable"&&Mr(i),bi(e._writableStreamController),n}function ni(e){return C((n,i)=>{let u={_resolve:n,_reject:i};e._writeRequests.push(u)})}function Ir(e,t){if(e._state==="writable"){Wr(e,t);return}Or(e)}function Wr(e,t){let n=e._writableStreamController;e._state="erroring",e._storedError=t;let i=e._writer;i!==void 0&&no(i,t),!ui(e)&&n._started&&Or(e)}function Or(e){e._state="errored",e._writableStreamController[Cn]();let t=e._storedError;if(e._writeRequests.forEach(u=>{u._reject(t)}),e._writeRequests=new G,e._pendingAbortRequest===void 0){It(e);return}let n=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,n._wasAlreadyErroring){n._reject(t),It(e);return}let i=e._writableStreamController[Rn](n._reason);v(i,()=>{n._resolve(),It(e)},u=>{n._reject(u),It(e)})}function oi(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function ai(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,Ir(e,t)}function ii(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let n=e._writer;n!==void 0&&co(n)}function si(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),Ir(e,t)}function re(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function ui(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function li(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function fi(e){e._inFlightWriteRequest=e._writeRequests.shift()}function It(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&Dr(t,e._storedError)}function qr(e,t){let n=e._writer;n!==void 0&&t!==e._backpressure&&(t?Ci(n):Mr(n)),e._backpressure=t}class at{constructor(t){if(ce(t,1,"WritableStreamDefaultWriter"),Zn(t,"First parameter"),Ne(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let n=t._state;if(n==="writable")!re(t)&&t._backpressure?zt(this):ho(this),jt(this);else if(n==="erroring")$r(this,t._storedError),jt(this);else if(n==="closed")ho(this),wi(this);else{let i=t._storedError;$r(this,i),fo(this,i)}}get closed(){return ke(this)?this._closedPromise:h(Be("closed"))}get desiredSize(){if(!ke(this))throw Be("desiredSize");if(this._ownerWritableStream===void 0)throw it("desiredSize");return mi(this)}get ready(){return ke(this)?this._readyPromise:h(Be("ready"))}abort(t=void 0){return ke(this)?this._ownerWritableStream===void 0?h(it("abort")):ci(this,t):h(Be("abort"))}close(){if(!ke(this))return h(Be("close"));let t=this._ownerWritableStream;return t===void 0?h(it("close")):re(t)?h(new TypeError("Cannot close an already-closing stream")):ro(this)}releaseLock(){if(!ke(this))throw Be("releaseLock");this._ownerWritableStream!==void 0&&oo(this)}write(t=void 0){return ke(this)?this._ownerWritableStream===void 0?h(it("write to")):ao(this,t):h(Be("write"))}}Object.defineProperties(at.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(at.prototype,o.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function ke(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof at}function ci(e,t){let n=e._ownerWritableStream;return Bt(n,t)}function ro(e){let t=e._ownerWritableStream;return to(t)}function di(e){let t=e._ownerWritableStream,n=t._state;return re(t)||n==="closed"?w(void 0):n==="errored"?h(t._storedError):ro(e)}function hi(e,t){e._closedPromiseState==="pending"?Dr(e,t):Ri(e,t)}function no(e,t){e._readyPromiseState==="pending"?mo(e,t):Ti(e,t)}function mi(e){let t=e._ownerWritableStream,n=t._state;return n==="errored"||n==="erroring"?null:n==="closed"?0:uo(t._writableStreamController)}function oo(e){let t=e._ownerWritableStream,n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");no(e,n),hi(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function ao(e,t){let n=e._ownerWritableStream,i=n._writableStreamController,u=yi(i,t);if(n!==e._ownerWritableStream)return h(it("write to"));let f=n._state;if(f==="errored")return h(n._storedError);if(re(n)||f==="closed")return h(new TypeError("The stream is closing or closed and cannot be written to"));if(f==="erroring")return h(n._storedError);let c=ni(n);return gi(i,t,u),c}let io={};class xe{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!jr(this))throw Lr("abortReason");return this._abortReason}get signal(){if(!jr(this))throw Lr("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!jr(this))throw Lr("error");this._controlledWritableStream._state==="writable"&&lo(this,t)}[Rn](t){let n=this._abortAlgorithm(t);return Wt(this),n}[Cn](){be(this)}}Object.defineProperties(xe.prototype,{error:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(xe.prototype,o.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function jr(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof xe}function so(e,t,n,i,u,f,c,b){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,be(t),t._abortReason=void 0,t._abortController=ti(),t._started=!1,t._strategySizeAlgorithm=b,t._strategyHWM=c,t._writeAlgorithm=i,t._closeAlgorithm=u,t._abortAlgorithm=f;let _=Fr(t);qr(e,_);let T=n(),W=w(T);v(W,()=>{t._started=!0,Ot(t)},B=>{t._started=!0,Ir(e,B)})}function pi(e,t,n,i){let u=Object.create(xe.prototype),f=()=>{},c=()=>w(void 0),b=()=>w(void 0),_=()=>w(void 0);t.start!==void 0&&(f=()=>t.start(u)),t.write!==void 0&&(c=T=>t.write(T,u)),t.close!==void 0&&(b=()=>t.close()),t.abort!==void 0&&(_=T=>t.abort(T)),so(e,u,f,c,b,_,n,i)}function Wt(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function bi(e){Cr(e,io,0),Ot(e)}function yi(e,t){try{return e._strategySizeAlgorithm(t)}catch(n){return zr(e,n),1}}function uo(e){return e._strategyHWM-e._queueTotalSize}function gi(e,t,n){try{Cr(e,t,n)}catch(u){zr(e,u);return}let i=e._controlledWritableStream;if(!re(i)&&i._state==="writable"){let u=Fr(e);qr(i,u)}Ot(e)}function Ot(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){Or(t);return}if(e._queue.length===0)return;let i=Da(e);i===io?_i(e):Si(e,i)}function zr(e,t){e._controlledWritableStream._state==="writable"&&lo(e,t)}function _i(e){let t=e._controlledWritableStream;li(t),Rr(e);let n=e._closeAlgorithm();Wt(e),v(n,()=>{ii(t)},i=>{si(t,i)})}function Si(e,t){let n=e._controlledWritableStream;fi(n);let i=e._writeAlgorithm(t);v(i,()=>{oi(n);let u=n._state;if(Rr(e),!re(n)&&u==="writable"){let f=Fr(e);qr(n,f)}Ot(e)},u=>{n._state==="writable"&&Wt(e),ai(n,u)})}function Fr(e){return uo(e)<=0}function lo(e,t){let n=e._controlledWritableStream;Wt(e),Wr(n,t)}function qt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Lr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Be(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function it(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function jt(e){e._closedPromise=C((t,n)=>{e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"})}function fo(e,t){jt(e),Dr(e,t)}function wi(e){jt(e),co(e)}function Dr(e,t){e._closedPromise_reject!==void 0&&(se(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Ri(e,t){fo(e,t)}function co(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function zt(e){e._readyPromise=C((t,n)=>{e._readyPromise_resolve=t,e._readyPromise_reject=n}),e._readyPromiseState="pending"}function $r(e,t){zt(e),mo(e,t)}function ho(e){zt(e),Mr(e)}function mo(e,t){e._readyPromise_reject!==void 0&&(se(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Ci(e){zt(e)}function Ti(e,t){$r(e,t)}function Mr(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let po=typeof DOMException<"u"?DOMException:void 0;function Pi(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function Ei(){let e=function(n,i){this.message=n||"",this.name=i||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let vi=Pi(po)?po:Ei();function bo(e,t,n,i,u,f){let c=De(e),b=Xn(t);e._disturbed=!0;let _=!1,T=w(void 0);return C((W,B)=>{let q;if(f!==void 0){if(q=()=>{let R=new vi("Aborted","AbortError"),E=[];i||E.push(()=>t._state==="writable"?Bt(t,R):w(void 0)),u||E.push(()=>e._state==="readable"?J(e,R):w(void 0)),D(()=>Promise.all(E.map(z=>z())),!0,R)},f.aborted){q();return}f.addEventListener("abort",q)}function we(){return C((R,E)=>{function z(Z){Z?R():k(ct(),z,E)}z(!1)})}function ct(){return _?w(!0):k(b._readyPromise,()=>C((R,E)=>{Je(c,{_chunkSteps:z=>{T=k(ao(b,z),void 0,a),R(!1)},_closeSteps:()=>R(!0),_errorSteps:E})}))}if(L(e,c._closedPromise,R=>{i?I(!0,R):D(()=>Bt(t,R),!0,R)}),L(t,b._closedPromise,R=>{u?I(!0,R):D(()=>J(e,R),!0,R)}),ne(e,c._closedPromise,()=>{n?I():D(()=>di(b))}),re(t)||t._state==="closed"){let R=new TypeError("the destination writable stream closed before all data could be piped to it");u?I(!0,R):D(()=>J(e,R),!0,R)}se(we());function Re(){let R=T;return k(T,()=>R!==T?Re():void 0)}function L(R,E,z){R._state==="errored"?z(R._storedError):te(E,z)}function ne(R,E,z){R._state==="closed"?z():U(E,z)}function D(R,E,z){if(_)return;_=!0,t._state==="writable"&&!re(t)?U(Re(),Z):Z();function Z(){v(R(),()=>O(E,z),Ce=>O(!0,Ce))}}function I(R,E){_||(_=!0,t._state==="writable"&&!re(t)?U(Re(),()=>O(R,E)):O(R,E))}function O(R,E){oo(b),le(c),f!==void 0&&f.removeEventListener("abort",q),R?B(E):W(void 0)}})}class Ue{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ft(this))throw $t("desiredSize");return Nr(this)}close(){if(!Ft(this))throw $t("close");if(!He(this))throw new TypeError("The stream is not in a state that permits close");ut(this)}enqueue(t=void 0){if(!Ft(this))throw $t("enqueue");if(!He(this))throw new TypeError("The stream is not in a state that permits enqueue");return Dt(this,t)}error(t=void 0){if(!Ft(this))throw $t("error");ye(this,t)}[br](t){be(this);let n=this._cancelAlgorithm(t);return Lt(this),n}[yr](t){let n=this._controlledReadableStream;if(this._queue.length>0){let i=Rr(this);this._closeRequested&&this._queue.length===0?(Lt(this),lt(n)):st(this),t._chunkSteps(i)}else An(n,t),st(this)}}Object.defineProperties(Ue.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(Ue.prototype,o.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Ft(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Ue}function st(e){if(!yo(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let n=e._pullAlgorithm();v(n,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,st(e))},i=>{ye(e,i)})}function yo(e){let t=e._controlledReadableStream;return!He(e)||!e._started?!1:!!(Se(t)&&_t(t)>0||Nr(e)>0)}function Lt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function ut(e){if(!He(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Lt(e),lt(t))}function Dt(e,t){if(!He(e))return;let n=e._controlledReadableStream;if(Se(n)&&_t(n)>0)wr(n,t,!1);else{let i;try{i=e._strategySizeAlgorithm(t)}catch(u){throw ye(e,u),u}try{Cr(e,t,i)}catch(u){throw ye(e,u),u}}st(e)}function ye(e,t){let n=e._controlledReadableStream;n._state==="readable"&&(be(e),Lt(e),wo(n,t))}function Nr(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Ai(e){return!yo(e)}function He(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function go(e,t,n,i,u,f,c){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,be(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=c,t._strategyHWM=f,t._pullAlgorithm=i,t._cancelAlgorithm=u,e._readableStreamController=t;let b=n();v(w(b),()=>{t._started=!0,st(t)},_=>{ye(t,_)})}function ki(e,t,n,i){let u=Object.create(Ue.prototype),f=()=>{},c=()=>w(void 0),b=()=>w(void 0);t.start!==void 0&&(f=()=>t.start(u)),t.pull!==void 0&&(c=()=>t.pull(u)),t.cancel!==void 0&&(b=_=>t.cancel(_)),go(e,u,f,c,b,n,i)}function $t(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Bi(e,t){return Ee(e._readableStreamController)?Wi(e):Ii(e)}function Ii(e,t){let n=De(e),i=!1,u=!1,f=!1,c,b,_,T,W,B=C(L=>{W=L});function q(){return i||(i=!0,Je(n,{_chunkSteps:ne=>{Q(()=>{i=!1;let D=ne,I=ne;u||Dt(_._readableStreamController,D),f||Dt(T._readableStreamController,I)})},_closeSteps:()=>{i=!1,u||ut(_._readableStreamController),f||ut(T._readableStreamController),(!u||!f)&&W(void 0)},_errorSteps:()=>{i=!1}})),w(void 0)}function we(L){if(u=!0,c=L,f){let ne=Ze([c,b]),D=J(e,ne);W(D)}return B}function ct(L){if(f=!0,b=L,u){let ne=Ze([c,b]),D=J(e,ne);W(D)}return B}function Re(){}return _=xr(Re,q,we),T=xr(Re,q,ct),te(n._closedPromise,L=>{ye(_._readableStreamController,L),ye(T._readableStreamController,L),(!u||!f)&&W(void 0)}),[_,T]}function Wi(e){let t=De(e),n=!1,i=!1,u=!1,f,c,b,_,T,W=C(I=>{T=I});function B(I){te(I._closedPromise,O=>{I===t&&(K(b._readableStreamController,O),K(_._readableStreamController,O),(!i||!u)&&T(void 0))})}function q(){Ae(t)&&(le(t),t=De(e),B(t)),Je(t,{_chunkSteps:O=>{Q(()=>{n=!1;let R=O,E=O;if(!i&&!u)try{E=Ln(O)}catch(z){K(b._readableStreamController,z),K(_._readableStreamController,z),T(J(e,z));return}i||Tt(b._readableStreamController,R),u||Tt(_._readableStreamController,E)})},_closeSteps:()=>{n=!1,i||et(b._readableStreamController),u||et(_._readableStreamController),b._readableStreamController._pendingPullIntos.length>0&&Pt(b._readableStreamController,0),_._readableStreamController._pendingPullIntos.length>0&&Pt(_._readableStreamController,0),(!i||!u)&&T(void 0)},_errorSteps:()=>{n=!1}})}function we(I,O){pe(t)&&(le(t),t=Gn(e),B(t));let R=O?_:b,E=O?b:_;Jn(t,I,{_chunkSteps:Z=>{Q(()=>{n=!1;let Ce=O?u:i;if(O?i:u)Ce||Et(R._readableStreamController,Z);else{let qo;try{qo=Ln(Z)}catch(Hr){K(R._readableStreamController,Hr),K(E._readableStreamController,Hr),T(J(e,Hr));return}Ce||Et(R._readableStreamController,Z),Tt(E._readableStreamController,qo)}})},_closeSteps:Z=>{n=!1;let Ce=O?u:i,Yt=O?i:u;Ce||et(R._readableStreamController),Yt||et(E._readableStreamController),Z!==void 0&&(Ce||Et(R._readableStreamController,Z),!Yt&&E._readableStreamController._pendingPullIntos.length>0&&Pt(E._readableStreamController,0)),(!Ce||!Yt)&&T(void 0)},_errorSteps:()=>{n=!1}})}function ct(){if(n)return w(void 0);n=!0;let I=Ar(b._readableStreamController);return I===null?q():we(I._view,!1),w(void 0)}function Re(){if(n)return w(void 0);n=!0;let I=Ar(_._readableStreamController);return I===null?q():we(I._view,!0),w(void 0)}function L(I){if(i=!0,f=I,u){let O=Ze([f,c]),R=J(e,O);T(R)}return W}function ne(I){if(u=!0,c=I,i){let O=Ze([f,c]),R=J(e,O);T(R)}return W}function D(){}return b=So(D,ct,L),_=So(D,Re,ne),B(t),[b,_]}function Oi(e,t){fe(e,t);let n=e,i=n?.autoAllocateChunkSize,u=n?.cancel,f=n?.pull,c=n?.start,b=n?.type;return{autoAllocateChunkSize:i===void 0?void 0:vn(i,`${t} has member 'autoAllocateChunkSize' that`),cancel:u===void 0?void 0:qi(u,n,`${t} has member 'cancel' that`),pull:f===void 0?void 0:ji(f,n,`${t} has member 'pull' that`),start:c===void 0?void 0:zi(c,n,`${t} has member 'start' that`),type:b===void 0?void 0:Fi(b,`${t} has member 'type' that`)}}function qi(e,t,n){return Y(e,n),i=>Pe(e,t,[i])}function ji(e,t,n){return Y(e,n),i=>Pe(e,t,[i])}function zi(e,t,n){return Y(e,n),i=>ue(e,t,[i])}function Fi(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Li(e,t){fe(e,t);let n=e?.mode;return{mode:n===void 0?void 0:Di(n,`${t} has member 'mode' that`)}}function Di(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function $i(e,t){fe(e,t);let n=e?.preventCancel;return{preventCancel:Boolean(n)}}function _o(e,t){fe(e,t);let n=e?.preventAbort,i=e?.preventCancel,u=e?.preventClose,f=e?.signal;return f!==void 0&&Mi(f,`${t} has member 'signal' that`),{preventAbort:Boolean(n),preventCancel:Boolean(i),preventClose:Boolean(u),signal:f}}function Mi(e,t){if(!Xa(e))throw new TypeError(`${t} is not an AbortSignal.`)}function Ni(e,t){fe(e,t);let n=e?.readable;gr(n,"readable","ReadableWritablePair"),Sr(n,`${t} has member 'readable' that`);let i=e?.writable;return gr(i,"writable","ReadableWritablePair"),Zn(i,`${t} has member 'writable' that`),{readable:n,writable:i}}class ge{constructor(t={},n={}){t===void 0?t=null:Pn(t,"First parameter");let i=kt(n,"Second parameter"),u=Oi(t,"First parameter");if(Ur(this),u.type==="bytes"){if(i.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let f=nt(i,0);Ua(this,u,f)}else{let f=At(i),c=nt(i,1);ki(this,u,c,f)}}get locked(){if(!_e(this))throw Ie("locked");return Se(this)}cancel(t=void 0){return _e(this)?Se(this)?h(new TypeError("Cannot cancel a stream that already has a reader")):J(this,t):h(Ie("cancel"))}getReader(t=void 0){if(!_e(this))throw Ie("getReader");return Li(t,"First parameter").mode===void 0?De(this):Gn(this)}pipeThrough(t,n={}){if(!_e(this))throw Ie("pipeThrough");ce(t,1,"pipeThrough");let i=Ni(t,"First parameter"),u=_o(n,"Second parameter");if(Se(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Ne(i.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let f=bo(this,i.writable,u.preventClose,u.preventAbort,u.preventCancel,u.signal);return se(f),i.readable}pipeTo(t,n={}){if(!_e(this))return h(Ie("pipeTo"));if(t===void 0)return h("Parameter 1 is required in 'pipeTo'.");if(!Me(t))return h(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let i;try{i=_o(n,"Second parameter")}catch(u){return h(u)}return Se(this)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Ne(t)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):bo(this,t,i.preventClose,i.preventAbort,i.preventCancel,i.signal)}tee(){if(!_e(this))throw Ie("tee");let t=Bi(this);return Ze(t)}values(t=void 0){if(!_e(this))throw Ie("values");let n=$i(t,"First parameter");return Fa(this,n.preventCancel)}}Object.defineProperties(ge.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(ge.prototype,o.toStringTag,{value:"ReadableStream",configurable:!0}),typeof o.asyncIterator=="symbol"&&Object.defineProperty(ge.prototype,o.asyncIterator,{value:ge.prototype.values,writable:!0,configurable:!0});function xr(e,t,n,i=1,u=()=>1){let f=Object.create(ge.prototype);Ur(f);let c=Object.create(Ue.prototype);return go(f,c,e,t,n,i,u),f}function So(e,t,n){let i=Object.create(ge.prototype);Ur(i);let u=Object.create($e.prototype);return Qn(i,u,e,t,n,0,void 0),i}function Ur(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function _e(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof ge}function Se(e){return e._reader!==void 0}function J(e,t){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return h(e._storedError);lt(e);let n=e._reader;n!==void 0&&Ae(n)&&(n._readIntoRequests.forEach(u=>{u._closeSteps(void 0)}),n._readIntoRequests=new G);let i=e._readableStreamController[br](t);return ie(i,a)}function lt(e){e._state="closed";let t=e._reader;t!==void 0&&(wn(t),pe(t)&&(t._readRequests.forEach(n=>{n._closeSteps()}),t._readRequests=new G))}function wo(e,t){e._state="errored",e._storedError=t;let n=e._reader;n!==void 0&&(pr(n,t),pe(n)?(n._readRequests.forEach(i=>{i._errorSteps(t)}),n._readRequests=new G):(n._readIntoRequests.forEach(i=>{i._errorSteps(t)}),n._readIntoRequests=new G))}function Ie(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Ro(e,t){fe(e,t);let n=e?.highWaterMark;return gr(n,"highWaterMark","QueuingStrategyInit"),{highWaterMark:_r(n)}}let Co=e=>e.byteLength;Object.defineProperty(Co,"name",{value:"size",configurable:!0});class Mt{constructor(t){ce(t,1,"ByteLengthQueuingStrategy"),t=Ro(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Po(this))throw To("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Po(this))throw To("size");return Co}}Object.defineProperties(Mt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(Mt.prototype,o.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function To(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Po(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Mt}let Eo=()=>1;Object.defineProperty(Eo,"name",{value:"size",configurable:!0});class Nt{constructor(t){ce(t,1,"CountQueuingStrategy"),t=Ro(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Ao(this))throw vo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Ao(this))throw vo("size");return Eo}}Object.defineProperties(Nt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(Nt.prototype,o.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function vo(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Ao(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Nt}function xi(e,t){fe(e,t);let n=e?.flush,i=e?.readableType,u=e?.start,f=e?.transform,c=e?.writableType;return{flush:n===void 0?void 0:Ui(n,e,`${t} has member 'flush' that`),readableType:i,start:u===void 0?void 0:Hi(u,e,`${t} has member 'start' that`),transform:f===void 0?void 0:Vi(f,e,`${t} has member 'transform' that`),writableType:c}}function Ui(e,t,n){return Y(e,n),i=>Pe(e,t,[i])}function Hi(e,t,n){return Y(e,n),i=>ue(e,t,[i])}function Vi(e,t,n){return Y(e,n),(i,u)=>Pe(e,t,[i,u])}class xt{constructor(t={},n={},i={}){t===void 0&&(t=null);let u=kt(n,"Second parameter"),f=kt(i,"Third parameter"),c=xi(t,"First parameter");if(c.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(c.writableType!==void 0)throw new RangeError("Invalid writableType specified");let b=nt(f,0),_=At(f),T=nt(u,1),W=At(u),B,q=C(we=>{B=we});Qi(this,q,T,W,b,_),Yi(this,c),c.start!==void 0?B(c.start(this._transformStreamController)):B(void 0)}get readable(){if(!ko(this))throw Oo("readable");return this._readable}get writable(){if(!ko(this))throw Oo("writable");return this._writable}}Object.defineProperties(xt.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(xt.prototype,o.toStringTag,{value:"TransformStream",configurable:!0});function Qi(e,t,n,i,u,f){function c(){return t}function b(q){return Zi(e,q)}function _(q){return Xi(e,q)}function T(){return es(e)}e._writable=ri(c,b,T,_,n,i);function W(){return ts(e)}function B(q){return Ht(e,q),w(void 0)}e._readable=xr(c,W,B,u,f),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Vt(e,!0),e._transformStreamController=void 0}function ko(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof xt}function Ut(e,t){ye(e._readable._readableStreamController,t),Ht(e,t)}function Ht(e,t){Bo(e._transformStreamController),zr(e._writable._writableStreamController,t),e._backpressure&&Vt(e,!1)}function Vt(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=C(n=>{e._backpressureChangePromise_resolve=n}),e._backpressure=t}class ft{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Qt(this))throw Gt("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return Nr(t)}enqueue(t=void 0){if(!Qt(this))throw Gt("enqueue");Io(this,t)}error(t=void 0){if(!Qt(this))throw Gt("error");Ki(this,t)}terminate(){if(!Qt(this))throw Gt("terminate");Ji(this)}}Object.defineProperties(ft.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(ft.prototype,o.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Qt(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof ft}function Gi(e,t,n,i){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=n,t._flushAlgorithm=i}function Yi(e,t){let n=Object.create(ft.prototype),i=f=>{try{return Io(n,f),w(void 0)}catch(c){return h(c)}},u=()=>w(void 0);t.transform!==void 0&&(i=f=>t.transform(f,n)),t.flush!==void 0&&(u=()=>t.flush(n)),Gi(e,n,i,u)}function Bo(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Io(e,t){let n=e._controlledTransformStream,i=n._readable._readableStreamController;if(!He(i))throw new TypeError("Readable side is not in a state that permits enqueue");try{Dt(i,t)}catch(f){throw Ht(n,f),n._readable._storedError}Ai(i)!==n._backpressure&&Vt(n,!0)}function Ki(e,t){Ut(e._controlledTransformStream,t)}function Wo(e,t){let n=e._transformAlgorithm(t);return ie(n,void 0,i=>{throw Ut(e._controlledTransformStream,i),i})}function Ji(e){let t=e._controlledTransformStream,n=t._readable._readableStreamController;ut(n);let i=new TypeError("TransformStream terminated");Ht(t,i)}function Zi(e,t){let n=e._transformStreamController;if(e._backpressure){let i=e._backpressureChangePromise;return ie(i,()=>{let u=e._writable;if(u._state==="erroring")throw u._storedError;return Wo(n,t)})}return Wo(n,t)}function Xi(e,t){return Ut(e,t),w(void 0)}function es(e){let t=e._readable,n=e._transformStreamController,i=n._flushAlgorithm();return Bo(n),ie(i,()=>{if(t._state==="errored")throw t._storedError;ut(t._readableStreamController)},u=>{throw Ut(e,u),t._storedError})}function ts(e){return Vt(e,!1),e._backpressureChangePromise}function Gt(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Oo(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Mt,r.CountQueuingStrategy=Nt,r.ReadableByteStreamController=$e,r.ReadableStream=ge,r.ReadableStreamBYOBReader=rt,r.ReadableStreamBYOBRequest=Xe,r.ReadableStreamDefaultController=Ue,r.ReadableStreamDefaultReader=Ke,r.TransformStream=xt,r.TransformStreamDefaultController=ft,r.WritableStream=ot,r.WritableStreamDefaultController=xe,r.WritableStreamDefaultWriter=at,Object.defineProperty(r,"__esModule",{value:!0})})});var ia=dt(()=>{if(!globalThis.ReadableStream)try{Object.assign(globalThis,require("stream/web"))}catch{Object.assign(globalThis,aa())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(a){let s=0,l=this;return new ReadableStream({type:"bytes",async pull(d){let m=await l.slice(s,Math.min(l.size,s+65536)).arrayBuffer();s+=m.byteLength,d.enqueue(new Uint8Array(m)),s===l.size&&d.close()}})})}catch{}});var Ju={};ss(Ju,{default:()=>ka});module.exports=us(Ju);var y=require("@raycast/api"),V=require("react"),yn=oe(Go()),Aa=oe(ta());var j=require("@raycast/api"),gt=require("react");var ee=require("@raycast/api");var Ca=oe(require("http"),1),Ta=oe(require("https"),1),ze=oe(require("zlib"),1),x=oe(require("stream"),1),Pa=oe(na(),1);var H=oe(require("stream"),1),dn=require("util");var ol=oe(ia(),1),sa=65536;async function*un(r,o=!0){for(let a of r)if("stream"in a)yield*a.stream();else if(ArrayBuffer.isView(a))if(o){let s=a.byteOffset,l=a.byteOffset+a.byteLength;for(;s!==l;){let d=Math.min(l-s,sa),p=a.buffer.slice(s,s+d);s+=p.byteLength,yield new Uint8Array(p)}}else yield a;else{let s=0;for(;s!==a.size;){let d=await a.slice(s,Math.min(a.size,s+sa)).arrayBuffer();s+=d.byteLength,yield new Uint8Array(d)}}}var ua=class ln{#e=[];#r="";#t=0;constructor(o=[],a={}){let s=0,l=o.map(p=>{let m;return ArrayBuffer.isView(p)?m=new Uint8Array(p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength)):p instanceof ArrayBuffer?m=new Uint8Array(p.slice(0)):p instanceof ln?m=p:m=new TextEncoder().encode(p),s+=ArrayBuffer.isView(m)?m.byteLength:m.size,m}),d=a.type===void 0?"":String(a.type);this.#r=/[^\u0020-\u007E]/.test(d)?"":d,this.#t=s,this.#e=l}get size(){return this.#t}get type(){return this.#r}async text(){let o=new TextDecoder,a="";for await(let s of un(this.#e,!1))a+=o.decode(s,{stream:!0});return a+=o.decode(),a}async arrayBuffer(){let o=new Uint8Array(this.size),a=0;for await(let s of un(this.#e,!1))o.set(s,a),a+=s.length;return o.buffer}stream(){let o=un(this.#e,!0);return new ReadableStream({type:"bytes",async pull(a){let s=await o.next();s.done?a.close():a.enqueue(s.value)}})}slice(o=0,a=this.size,s=""){let{size:l}=this,d=o<0?Math.max(l+o,0):Math.min(o,l),p=a<0?Math.max(l+a,0):Math.min(a,l),m=Math.max(p-d,0),g=this.#e,S=[],P=0;for(let w of g){if(P>=m)break;let h=ArrayBuffer.isView(w)?w.byteLength:w.size;if(d&&h<=d)d-=h,p-=h;else{let k;ArrayBuffer.isView(w)?(k=w.subarray(d,Math.min(h,p)),P+=k.byteLength):(k=w.slice(d,Math.min(h,p)),P+=k.size),S.push(k),d=0}}let C=new ln([],{type:String(s).toLowerCase()});return C.#t=m,C.#e=S,C}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](o){return o&&typeof o=="object"&&typeof o.constructor=="function"&&(typeof o.stream=="function"||typeof o.arrayBuffer=="function")&&/^(Blob|File)$/.test(o[Symbol.toStringTag])}};Object.defineProperties(ua.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var $u=ua,la=$u;var de=class extends Error{constructor(o,a){super(o),Error.captureStackTrace(this,this.constructor),this.type=a}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var M=class extends de{constructor(o,a,s){super(o,a),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var ca=require("crypto");var bt=Symbol.toStringTag,fn=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[bt]==="URLSearchParams",ae=r=>typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[bt]);function nr(r){return typeof r=="object"&&typeof r.append=="function"&&typeof r.set=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.delete=="function"&&typeof r.keys=="function"&&typeof r.values=="function"&&typeof r.entries=="function"&&typeof r.constructor=="function"&&r[bt]==="FormData"}var fa=r=>typeof r=="object"&&(r[bt]==="AbortSignal"||r[bt]==="EventTarget");var Ye=`\r
`,cn="-".repeat(2),Mu=Buffer.byteLength(Ye),da=r=>`${cn}${r}${cn}${Ye.repeat(2)}`;function ha(r,o,a){let s="";return s+=`${cn}${r}${Ye}`,s+=`Content-Disposition: form-data; name="${o}"`,ae(a)&&(s+=`; filename="${a.name}"${Ye}`,s+=`Content-Type: ${a.type||"application/octet-stream"}`),`${s}${Ye.repeat(2)}`}var ma=()=>(0,ca.randomBytes)(8).toString("hex");async function*pa(r,o){for(let[a,s]of r)yield ha(o,a,s),ae(s)?yield*s.stream():yield s,yield Ye;yield da(o)}function ba(r,o){let a=0;for(let[s,l]of r)a+=Buffer.byteLength(ha(o,s,l)),a+=ae(l)?l.size:Buffer.byteLength(String(l)),a+=Mu;return a+=Buffer.byteLength(da(o)),a}var N=Symbol("Body internals"),Te=class{constructor(o,{size:a=0}={}){let s=null;o===null?o=null:fn(o)?o=Buffer.from(o.toString()):ae(o)||Buffer.isBuffer(o)||(dn.types.isAnyArrayBuffer(o)?o=Buffer.from(o):ArrayBuffer.isView(o)?o=Buffer.from(o.buffer,o.byteOffset,o.byteLength):o instanceof H.default||(nr(o)?(s=`NodeFetchFormDataBoundary${ma()}`,o=H.default.Readable.from(pa(o,s))):o=Buffer.from(String(o)))),this[N]={body:o,boundary:s,disturbed:!1,error:null},this.size=a,o instanceof H.default&&o.on("error",l=>{let d=l instanceof de?l:new M(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[N].error=d})}get body(){return this[N].body}get bodyUsed(){return this[N].disturbed}async arrayBuffer(){let{buffer:o,byteOffset:a,byteLength:s}=await or(this);return o.slice(a,a+s)}async blob(){let o=this.headers&&this.headers.get("content-type")||this[N].body&&this[N].body.type||"",a=await this.buffer();return new la([a],{type:o})}async json(){let o=await or(this);return JSON.parse(o.toString())}async text(){return(await or(this)).toString()}buffer(){return or(this)}};Object.defineProperties(Te.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function or(r){if(r[N].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[N].disturbed=!0,r[N].error)throw r[N].error;let{body:o}=r;if(o===null)return Buffer.alloc(0);if(ae(o)&&(o=H.default.Readable.from(o.stream())),Buffer.isBuffer(o))return o;if(!(o instanceof H.default))return Buffer.alloc(0);let a=[],s=0;try{for await(let l of o){if(r.size>0&&s+l.length>r.size){let d=new M(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw o.destroy(d),d}s+=l.length,a.push(l)}}catch(l){throw l instanceof de?l:new M(`Invalid response body while trying to fetch ${r.url}: ${l.message}`,"system",l)}if(o.readableEnded===!0||o._readableState.ended===!0)try{return a.every(l=>typeof l=="string")?Buffer.from(a.join("")):Buffer.concat(a,s)}catch(l){throw new M(`Could not create Buffer from response body for ${r.url}: ${l.message}`,"system",l)}else throw new M(`Premature close of server response while trying to fetch ${r.url}`)}var ar=(r,o)=>{let a,s,{body:l}=r;if(r.bodyUsed)throw new Error("cannot clone body after it is used");return l instanceof H.default&&typeof l.getBoundary!="function"&&(a=new H.PassThrough({highWaterMark:o}),s=new H.PassThrough({highWaterMark:o}),l.pipe(a),l.pipe(s),r[N].body=a,l=s),l},ir=(r,o)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":fn(r)?"application/x-www-form-urlencoded;charset=UTF-8":ae(r)?r.type||null:Buffer.isBuffer(r)||dn.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${r.getBoundary()}`:nr(r)?`multipart/form-data; boundary=${o[N].boundary}`:r instanceof H.default?null:"text/plain;charset=UTF-8",ya=r=>{let{body:o}=r;return o===null?0:ae(o)?o.size:Buffer.isBuffer(o)?o.length:o&&typeof o.getLengthSync=="function"?o.hasKnownLength&&o.hasKnownLength()?o.getLengthSync():null:nr(o)?ba(r[N].boundary):null},ga=(r,{body:o})=>{o===null?r.end():ae(o)?H.default.Readable.from(o.stream()).pipe(r):Buffer.isBuffer(o)?(r.write(o),r.end()):o.pipe(r)};var hn=require("util"),yt=oe(require("http"),1),sr=typeof yt.default.validateHeaderName=="function"?yt.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let o=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(o,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),o}},mn=typeof yt.default.validateHeaderValue=="function"?yt.default.validateHeaderValue:(r,o)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(o)){let a=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(a,"code",{value:"ERR_INVALID_CHAR"}),a}},$=class extends URLSearchParams{constructor(o){let a=[];if(o instanceof $){let s=o.raw();for(let[l,d]of Object.entries(s))a.push(...d.map(p=>[l,p]))}else if(o!=null)if(typeof o=="object"&&!hn.types.isBoxedPrimitive(o)){let s=o[Symbol.iterator];if(s==null)a.push(...Object.entries(o));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");a=[...o].map(l=>{if(typeof l!="object"||hn.types.isBoxedPrimitive(l))throw new TypeError("Each header pair must be an iterable object");return[...l]}).map(l=>{if(l.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...l]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return a=a.length>0?a.map(([s,l])=>(sr(s),mn(s,String(l)),[String(s).toLowerCase(),String(l)])):void 0,super(a),new Proxy(this,{get(s,l,d){switch(l){case"append":case"set":return(p,m)=>(sr(p),mn(p,String(m)),URLSearchParams.prototype[l].call(s,String(p).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return p=>(sr(p),URLSearchParams.prototype[l].call(s,String(p).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,l,d)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(o){let a=this.getAll(o);if(a.length===0)return null;let s=a.join(", ");return/^content-encoding$/i.test(o)&&(s=s.toLowerCase()),s}forEach(o,a=void 0){for(let s of this.keys())Reflect.apply(o,a,[this.get(s),s,this])}*values(){for(let o of this.keys())yield this.get(o)}*entries(){for(let o of this.keys())yield[o,this.get(o)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((o,a)=>(o[a]=this.getAll(a),o),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((o,a)=>{let s=this.getAll(a);return a==="host"?o[a]=s[0]:o[a]=s.length>1?s:s[0],o},{})}};Object.defineProperties($.prototype,["get","entries","forEach","values"].reduce((r,o)=>(r[o]={enumerable:!0},r),{}));function _a(r=[]){return new $(r.reduce((o,a,s,l)=>(s%2===0&&o.push(l.slice(s,s+2)),o),[]).filter(([o,a])=>{try{return sr(o),mn(o,String(a)),!0}catch{return!1}}))}var Nu=new Set([301,302,303,307,308]),ur=r=>Nu.has(r);var X=Symbol("Response internals"),F=class extends Te{constructor(o=null,a={}){super(o,a);let s=a.status!=null?a.status:200,l=new $(a.headers);if(o!==null&&!l.has("Content-Type")){let d=ir(o);d&&l.append("Content-Type",d)}this[X]={type:"default",url:a.url,status:s,statusText:a.statusText||"",headers:l,counter:a.counter,highWaterMark:a.highWaterMark}}get type(){return this[X].type}get url(){return this[X].url||""}get status(){return this[X].status}get ok(){return this[X].status>=200&&this[X].status<300}get redirected(){return this[X].counter>0}get statusText(){return this[X].statusText}get headers(){return this[X].headers}get highWaterMark(){return this[X].highWaterMark}clone(){return new F(ar(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(o,a=302){if(!ur(a))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new F(null,{headers:{location:new URL(o).toString()},status:a})}static error(){let o=new F(null,{status:0,statusText:""});return o[X].type="error",o}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(F.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var wa=require("url");var Sa=r=>{if(r.search)return r.search;let o=r.href.length-1,a=r.hash||(r.href[o]==="#"?"#":"");return r.href[o-a.length]==="?"?"?":""};var he=Symbol("Request internals"),lr=r=>typeof r=="object"&&typeof r[he]=="object",me=class extends Te{constructor(o,a={}){let s;lr(o)?s=new URL(o.url):(s=new URL(o),o={});let l=a.method||o.method||"GET";if(l=l.toUpperCase(),(a.body!=null||lr(o))&&o.body!==null&&(l==="GET"||l==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let d=a.body?a.body:lr(o)&&o.body!==null?ar(o):null;super(d,{size:a.size||o.size||0});let p=new $(a.headers||o.headers||{});if(d!==null&&!p.has("Content-Type")){let g=ir(d,this);g&&p.append("Content-Type",g)}let m=lr(o)?o.signal:null;if("signal"in a&&(m=a.signal),m!=null&&!fa(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");this[he]={method:l,redirect:a.redirect||o.redirect||"follow",headers:p,parsedURL:s,signal:m},this.follow=a.follow===void 0?o.follow===void 0?20:o.follow:a.follow,this.compress=a.compress===void 0?o.compress===void 0?!0:o.compress:a.compress,this.counter=a.counter||o.counter||0,this.agent=a.agent||o.agent,this.highWaterMark=a.highWaterMark||o.highWaterMark||16384,this.insecureHTTPParser=a.insecureHTTPParser||o.insecureHTTPParser||!1}get method(){return this[he].method}get url(){return(0,wa.format)(this[he].parsedURL)}get headers(){return this[he].headers}get redirect(){return this[he].redirect}get signal(){return this[he].signal}clone(){return new me(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(me.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});var Ra=r=>{let{parsedURL:o}=r[he],a=new $(r[he].headers);a.has("Accept")||a.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let m=ya(r);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&a.set("Content-Length",s),a.has("User-Agent")||a.set("User-Agent","node-fetch"),r.compress&&!a.has("Accept-Encoding")&&a.set("Accept-Encoding","gzip,deflate,br");let{agent:l}=r;typeof l=="function"&&(l=l(o)),!a.has("Connection")&&!l&&a.set("Connection","close");let d=Sa(o);return{path:o.pathname+d,pathname:o.pathname,hostname:o.hostname,protocol:o.protocol,port:o.port,hash:o.hash,search:o.search,query:o.query,href:o.href,method:r.method,headers:a[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:l}};var fr=class extends de{constructor(o,a="aborted"){super(o,a)}};var xu=new Set(["data:","http:","https:"]);async function cr(r,o){return new Promise((a,s)=>{let l=new me(r,o),d=Ra(l);if(!xu.has(d.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${d.protocol.replace(/:$/,"")}" is not supported.`);if(d.protocol==="data:"){let h=(0,Pa.default)(l.url),k=new F(h,{headers:{"Content-Type":h.typeFull}});a(k);return}let p=(d.protocol==="https:"?Ta.default:Ca.default).request,{signal:m}=l,g=null,S=()=>{let h=new fr("The operation was aborted.");s(h),l.body&&l.body instanceof x.default.Readable&&l.body.destroy(h),!(!g||!g.body)&&g.body.emit("error",h)};if(m&&m.aborted){S();return}let P=()=>{S(),w()},C=p(d);m&&m.addEventListener("abort",P);let w=()=>{C.abort(),m&&m.removeEventListener("abort",P)};C.on("error",h=>{s(new M(`request to ${l.url} failed, reason: ${h.message}`,"system",h)),w()}),Uu(C,h=>{g.body.destroy(h)}),process.version<"v14"&&C.on("socket",h=>{let k;h.prependListener("end",()=>{k=h._eventsCount}),h.prependListener("close",v=>{if(g&&k<h._eventsCount&&!v){let U=new Error("Premature close");U.code="ERR_STREAM_PREMATURE_CLOSE",g.body.emit("error",U)}})}),C.on("response",h=>{C.setTimeout(0);let k=_a(h.rawHeaders);if(ur(h.statusCode)){let se=k.get("Location"),Q=se===null?null:new URL(se,l.url);switch(l.redirect){case"error":s(new M(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),w();return;case"manual":Q!==null&&k.set("Location",Q);break;case"follow":{if(Q===null)break;if(l.counter>=l.follow){s(new M(`maximum redirect reached at: ${l.url}`,"max-redirect")),w();return}let ue={headers:new $(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:l.body,signal:l.signal,size:l.size};if(h.statusCode!==303&&l.body&&o.body instanceof x.default.Readable){s(new M("Cannot follow redirect with body being a readable stream","unsupported-redirect")),w();return}(h.statusCode===303||(h.statusCode===301||h.statusCode===302)&&l.method==="POST")&&(ue.method="GET",ue.body=void 0,ue.headers.delete("content-length")),a(cr(new me(Q,ue))),w();return}default:return s(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}m&&h.once("end",()=>{m.removeEventListener("abort",P)});let v=(0,x.pipeline)(h,new x.PassThrough,s);process.version<"v12.10"&&h.on("aborted",P);let U={url:l.url,status:h.statusCode,statusText:h.statusMessage,headers:k,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},te=k.get("Content-Encoding");if(!l.compress||l.method==="HEAD"||te===null||h.statusCode===204||h.statusCode===304){g=new F(v,U),a(g);return}let ie={flush:ze.default.Z_SYNC_FLUSH,finishFlush:ze.default.Z_SYNC_FLUSH};if(te==="gzip"||te==="x-gzip"){v=(0,x.pipeline)(v,ze.default.createGunzip(ie),s),g=new F(v,U),a(g);return}if(te==="deflate"||te==="x-deflate"){(0,x.pipeline)(h,new x.PassThrough,s).once("data",Q=>{v=(Q[0]&15)===8?(0,x.pipeline)(v,ze.default.createInflate(),s):(0,x.pipeline)(v,ze.default.createInflateRaw(),s),g=new F(v,U),a(g)});return}if(te==="br"){v=(0,x.pipeline)(v,ze.default.createBrotliDecompress(),s),g=new F(v,U),a(g);return}g=new F(v,U),a(g)}),ga(C,l)})}function Uu(r,o){let a=Buffer.from(`0\r
\r
`),s=!1,l=!1,d;r.on("response",p=>{let{headers:m}=p;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),r.on("socket",p=>{let m=()=>{if(s&&!l){let g=new Error("Premature close");g.code="ERR_STREAM_PREMATURE_CLOSE",o(g)}};p.prependListener("close",m),r.on("abort",()=>{p.removeListener("close",m)}),p.on("data",g=>{l=Buffer.compare(g.slice(-5),a)===0,!l&&d&&(l=Buffer.compare(d.slice(-3),a.slice(0,3))===0&&Buffer.compare(g.slice(-2),a.slice(3))===0),d=g})})}var Hu="https://api.clockify.me/api/v1",Ea=r=>!r?.timeInterval?.end;async function Fe(r,{method:o,body:a,headers:s,...l}={}){let d=(0,ee.getPreferenceValues)(),p=String(d?.token);try{let m=await cr(`${Hu}${r}`,{headers:{"X-Api-Key":p,"Content-Type":"application/json",...s},method:o||"GET",body:a?JSON.stringify(a):null,...l});return m.ok?{data:await m.json()}:(m.status===401&&((0,ee.clearLocalStorage)(),(0,ee.showToast)(ee.ToastStyle.Failure,"Invalid API Key detected")),{error:m.statusText})}catch(m){return{error:m}}}function va(){let r=(0,ee.getPreferenceValues)();return String(r?.token).length!==48?((0,ee.showToast)(ee.ToastStyle.Failure,"Invalid API Key detected"),!1):!0}function Vu(r,o){let a=Math.abs(r.getTime()-o.getTime()),s=a%1e3;a=(a-s)/1e3;let l=a%60;a=(a-l)/60;let d=a%60;a=(a-d)/60;let p=a,m=l<=9&&l>=0?`0${l}`:l,g=d<=9&&d>=0?`0${d}`:d;return(p<=9&&p>=0?`0${p}`:p)+":"+g+":"+m}function pn(r){return r?.timeInterval?.start?Vu(new Date,new Date(r.timeInterval.start)):""}function dr(){let[r,o]=(0,gt.useState)(()=>va()),[a,s]=(0,gt.useState)({});return(0,gt.useEffect)(()=>{if(!r){(0,j.clearLocalStorage)();return}async function l(){let d=await(0,j.getLocalStorageItem)("name"),p=await(0,j.getLocalStorageItem)("userId"),m=await(0,j.getLocalStorageItem)("workspaceId");if(p&&m&&d){s({userId:p,workspaceId:m,name:d});return}async function g(){(0,j.showToast)(j.ToastStyle.Animated,"Loading\u2026");let{data:S,error:P}=await Fe("/user");S?((0,j.setLocalStorageItem)("userId",S.id),(0,j.setLocalStorageItem)("workspaceId",S.defaultWorkspace),(0,j.setLocalStorageItem)("name",S.name),s({userId:S.id,workspaceId:S.defaultWorkspace,name:S.name}),(0,j.showToast)(j.ToastStyle.Success,"Clockify is ready")):P==="Unauthorized"?((0,j.showToast)(j.ToastStyle.Failure,"Invalid API Key detected"),o(!1)):(0,j.showToast)(j.ToastStyle.Failure,"An error ccurred")}g()}l()},[r]),{config:a,isValidToken:r,setIsValidToken:o}}var A=require("react/jsx-runtime");function Qu(r){let[o,a]=(0,V.useState)(pn(r));return(0,V.useEffect)(()=>{let s=setInterval(()=>a(pn(r)),1e3);return()=>clearInterval(s)},[]),o}function Gu({entry:r,updateTimeEntries:o}){let a=Qu(r);return(0,A.jsx)(y.List.Item,{id:r.id,title:r.project?.clientName||"No Client",subtitle:`${r.description||"No Description"}`,accessoryTitle:`${a}  -  ${r.project?.name}`,icon:{source:y.Icon.Clock,tintColor:r.project?.color},keywords:[...r.description?.split(" ")??[],...r.project?.name.split(" ")??[]],accessoryIcon:{source:y.Icon.Dot,tintColor:r.project?.color},actions:(0,A.jsx)(y.ActionPanel,{children:(0,A.jsx)(y.ActionPanelItem,{title:"Stop Timer",onAction:()=>Ku().then(()=>o())})})})}function ka(){let{config:r,isValidToken:o,setIsValidToken:a}=dr(),[s,l]=(0,V.useState)([]),[d,p]=(0,V.useState)(!1),{push:m}=(0,y.useNavigation)();(0,V.useEffect)(()=>{if((0,yn.default)(r)||!o)return;async function S(){p(!0);let P=await(0,y.getLocalStorageItem)("entries");P&&l(JSON.parse(P));let C=await bn({onError:a});C&&(l(C),(0,y.setLocalStorageItem)("entries",JSON.stringify(C))),p(!1)}S()},[r,o]);let g=(0,V.useCallback)(()=>{p(!0),bn({onError:a}).then(S=>{S&&(l(S),(0,y.setLocalStorageItem)("entries",JSON.stringify(S))),p(!1)}).catch(()=>p(!1))},[bn]);return(0,A.jsx)(y.List,{isLoading:d,searchBarPlaceholder:"Search time entries",children:o?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(y.List.Section,{title:"What are you working on?",children:(0,A.jsx)(y.List.Item,{icon:{source:y.Icon.ArrowRight},title:"Start New Timer",actions:(0,A.jsx)(y.ActionPanel,{children:(0,A.jsx)(y.ActionPanel.Item,{title:"Start New Timer",onAction:()=>m((0,A.jsx)(Yu,{updateTimeEntries:g}))})})})}),(0,A.jsx)(y.List.Section,{title:"Latest entries",children:s.map(S=>Ea(S)?(0,A.jsx)(Gu,{entry:S,updateTimeEntries:g},S.id):(0,A.jsx)(y.List.Item,{id:S.id,title:S.project?.clientName||"No Client",subtitle:S.description||"No Description",accessoryTitle:S.project?.name,icon:{source:y.Icon.Circle,tintColor:S.project?.color},keywords:[...S.description?.split(" ")??[],...S.project?.name.split(" ")??[]],accessoryIcon:{source:y.Icon.Dot,tintColor:S.project?.color},actions:(0,A.jsx)(y.ActionPanel,{children:(0,A.jsx)(y.ActionPanelItem,{title:"Start Timer",onAction:()=>{Ba(S.description,S.projectId).then(()=>g())}})})},S.id))})]}):(0,A.jsx)(y.List.Item,{icon:y.Icon.ExclamationMark,title:"Invalid API Key Detected",accessoryTitle:"Go to Extensions \u2192 Clockify"})})}function Yu({updateTimeEntries:r}){let{config:o}=dr(),[a,s]=(0,V.useState)([]),[l,d]=(0,V.useState)(!1),{pop:p}=(0,y.useNavigation)();return(0,V.useEffect)(()=>{if((0,yn.default)(o))return;async function m(){d(!0);let g=await(0,y.getLocalStorageItem)("projects");g&&s(JSON.parse(g));let{data:S}=await Fe(`/workspaces/${o.workspaceId}/projects?page-size=1000`);s(S||[]),(0,y.setLocalStorageItem)("projects",JSON.stringify(S)),d(!1)}m()},[o]),(0,A.jsxs)(y.Form,{navigationTitle:"Add new time entry",isLoading:l,actions:(0,A.jsxs)(y.ActionPanel,{children:[(0,A.jsx)(y.SubmitFormAction,{title:"Start",onSubmit:({description:m,projectId:g})=>{m&&g?(Ba(m,g).then(()=>r()),p()):(0,y.showToast)(y.ToastStyle.Failure,"All fields are required")}}),(0,A.jsx)(y.ActionPanelItem,{title:"Discard",onAction:p})]}),children:[(0,A.jsx)(y.Form.Dropdown,{id:"projectId",title:"Project",children:a.map(m=>(0,A.jsx)(y.Form.Dropdown.Item,{value:m.id,title:`${m.name} - ${m?.clientName||"No Client"}`,icon:{source:y.Icon.Circle,tintColor:m.color}},m.id))}),(0,A.jsx)(y.Form.TextField,{id:"description",defaultValue:"",title:"Description"})]})}async function bn({onError:r}){let o=await(0,y.getLocalStorageItem)("workspaceId"),a=await(0,y.getLocalStorageItem)("userId"),{data:s,error:l}=await Fe(`/workspaces/${o}/user/${a}/time-entries?hydrated=true&page-size=500`);return l==="Unauthorized"?(r&&r(!1),[]):s?.length?(0,Aa.default)(s,(p,m)=>p.projectId===m.projectId&&p.description===m.description):[]}async function Ku(){(0,y.showToast)(y.ToastStyle.Animated,"Stopping\u2026");let r=await(0,y.getLocalStorageItem)("workspaceId"),o=await(0,y.getLocalStorageItem)("userId"),{data:a,error:s}=await Fe(`/workspaces/${r}/user/${o}/time-entries`,{method:"PATCH",body:{end:new Date().toISOString()}});!s&&a?(0,y.showToast)(y.ToastStyle.Success,"Timer stopped"):(0,y.showToast)(y.ToastStyle.Failure,"No timer running")}async function Ba(r,o){(0,y.showToast)(y.ToastStyle.Animated,"Starting\u2026");let a=await(0,y.getLocalStorageItem)("workspaceId"),{data:s}=await Fe(`/workspaces/${a}/time-entries`,{method:"POST",body:{description:r,taskId:null,projectId:o,timeInterval:{start:new Date().toISOString(),end:null,duration:null},customFieldValues:[]}});s?.id?(0,y.showToast)(y.ToastStyle.Success,"Timer is running"):(0,y.showToast)(y.ToastStyle.Failure,"Timer could not be started")}0&&(module.exports={});
