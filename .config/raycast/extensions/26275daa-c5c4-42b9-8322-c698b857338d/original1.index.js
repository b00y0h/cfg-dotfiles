"use strict";var p=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var L=(s,o)=>{for(var a in o)p(s,a,{get:o[a],enumerable:!0})},F=(s,o,a,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let d of E(o))!O.call(s,d)&&d!==a&&p(s,d,{get:()=>o[d],enumerable:!(c=C(o,d))||c.enumerable});return s};var T=s=>F(p({},"__esModule",{value:!0}),s);var B={};L(B,{default:()=>P});module.exports=T(B);var r=require("@raycast/api"),w=require("child_process"),u=require("react"),l=require("react/jsx-runtime"),N=["connected","connecting","disconnecting","disconnected","invalid"],x=s=>s.sort((a,c)=>{let d=N.indexOf(a.status),k=N.indexOf(c.status);return d<k?-1:d>k?1:0}),R=s=>{let o=/\((\d+)\)\s+(.*?)\s+\(Hardware Port: (.*?), Device: (.*?)\)/g;return Array.from(s.matchAll(o)).map(c=>({id:c[1],name:c[2],hardwarePort:c[3],device:c[4],status:"disconnected"}))};function P(){let[s,o]=(0,u.useState)(!0),[a,c]=(0,u.useState)(),[d,k]=(0,u.useState)(),[v,m]=(0,u.useState)({}),h=()=>new Promise((e,n)=>{(0,w.exec)("/usr/sbin/networksetup -listnetworkserviceorder",(t,i)=>{t!=null?n(t):e(i.trim())})}),b=e=>(e=e.replace(/"/g,'\\"'),new Promise((n,t)=>{(0,w.exec)(`/usr/sbin/networksetup -showpppoestatus "${e}"`,(i,S)=>{i!=null?t(i):n(S.trim())})})),g=()=>{h().then(e=>{let n=["Wi-Fi","Bluetooth PAN","Thunderbolt Bridge"],[t]=e.split(`
`);return k(t),R(e).filter(S=>!n.includes(S.name))}).then(e=>{let n=e.map(async t=>b(t.name).then(i=>({...t,status:i})));Promise.all(n).then(t=>{let i=t.reduce((S,f)=>({...S,[f.id]:f}),{});m(i),o(!1)})}).catch(e=>{c(e)})},y=e=>{let n=e.name.replace(/"/g,'\\"');(0,w.exec)(`/usr/sbin/networksetup -connectpppoeservice "${n}"`,t=>{if(t!=null){c(t);return}m({...v,[e.id]:{...e,status:"connecting"}})})},I=e=>{let n=e.name.replace(/"/g,'\\"');(0,w.exec)(`/usr/sbin/networksetup -disconnectpppoeservice "${n}"`,t=>{if(t!=null){c(t);return}m({...v,[e.id]:{...e,status:"disconnecting"}})})};(0,u.useEffect)(()=>{let e;return!s&&(Object.values(v).find(n=>n.status==="connecting")||Object.values(v).find(n=>n.status==="disconnecting"))&&(e=setInterval(()=>{g()},500)),()=>e?clearInterval(e):void 0},[s,v]),(0,u.useEffect)(()=>{g()},[]),a&&(0,r.showToast)(r.Toast.Style.Failure,"Something went wrong",a.message);let A=({service:e})=>{let n,t,i;switch(e.status){case"disconnected":n="Connect",t=y,i=r.Icon.Circle;break;case"connected":n="Disconnect",t=I,i=r.Icon.Checkmark;break;case"connecting":case"disconnecting":i=r.Icon.CircleEllipsis;break;default:i=r.Icon.XMarkCircle;break}return(0,l.jsx)(r.List.Item,{icon:i,title:e.name,actions:n&&(0,l.jsx)(r.ActionPanel,{children:(0,l.jsx)(r.Action,{title:n,onAction:()=>t&&t(e)})})})};return(0,l.jsx)(r.List,{isLoading:s,children:(0,l.jsx)(r.List.Section,{title:d,children:x(Object.values(v)).map(e=>(0,l.jsx)(A,{service:e},e.id))})})}
